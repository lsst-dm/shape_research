
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Construction of a likelyhood function for the moments of an image &#8212; Likelyhood Of Shapes In Moment Space  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="construction-of-a-likelyhood-function-for-the-moments-of-an-image">
<h1>Construction of a likelyhood function for the moments of an image<a class="headerlink" href="#construction-of-a-likelyhood-function-for-the-moments-of-an-image" title="Permalink to this headline">¶</a></h1>
<div class="section" id="weighted-moments">
<h2>Weighted Moments<a class="headerlink" href="#weighted-moments" title="Permalink to this headline">¶</a></h2>
<p>Define the weighted moments as measured from the image. Let <span class="math">\(r_i\)</span> be a
vector <span class="math">\([x_i,y_i]\)</span>.</p>
<div class="math">
\[R_0 = \sum_i z(r_i)w(r_i)\]</div>
<div class="math" id="equation-first_raw_moment">
<span class="eqno">(1)<a class="headerlink" href="#equation-first_raw_moment" title="Permalink to this equation">¶</a></span>\[R_1 = \sum_i z(r_i)w(r_i)r_i \quad [1]\]</div>
<div class="math" id="equation-second_raw_moment">
<span class="eqno">(2)<a class="headerlink" href="#equation-second_raw_moment" title="Permalink to this equation">¶</a></span>\[R_2 = \sum_i z(r_i)W(r_i)r_ir_i^T \quad (3)\]</div>
</div>
<div class="section" id="normalized-weighted-moments">
<h2>Normalized Weighted Moments<a class="headerlink" href="#normalized-weighted-moments" title="Permalink to this headline">¶</a></h2>
<p>The normalized weighted moments can be calculated as follows:</p>
<div class="math" id="equation-zeroth_norm_moment">
<span class="eqno">(3)<a class="headerlink" href="#equation-zeroth_norm_moment" title="Permalink to this equation">¶</a></span>\[M_0 = R_0 \quad\]</div>
<div class="math" id="equation-first_norm_moment">
<span class="eqno">(4)<a class="headerlink" href="#equation-first_norm_moment" title="Permalink to this equation">¶</a></span>\[M_1 = \frac{R_1}{M_0} \quad(5)\]</div>
<div class="math" id="equation-second_norm_moment">
<span class="eqno">(5)<a class="headerlink" href="#equation-second_norm_moment" title="Permalink to this equation">¶</a></span>\[M_ 2 = \frac{R_2}{M_0} - M_1M_1^T \quad\]</div>
</div>
<div class="section" id="weight-function">
<h2>Weight Function<a class="headerlink" href="#weight-function" title="Permalink to this headline">¶</a></h2>
<p>We will define the weight function used in calculating moments to be an
elliptical Gaussian:</p>
<div class="math">
\[ \begin{align}\begin{aligned}w(r_i) = \frac{e^{-\frac{1}{2}r_iC^{-1}_2r_i^T}}{w_0}\\w_0 = \int_{-\infty}^{\infty}e^{-\frac{1}{2}rC^{-1}_2r^T}d^kr\end{aligned}\end{align} \]</div>
<div class="section" id="debiasing">
<h3>Debiasing<a class="headerlink" href="#debiasing" title="Permalink to this headline">¶</a></h3>
<p>The weight function used in calculating the moments is useful for suppressing
extranious contributions from noise, but it also biases the measurement. To
correct for this, we can calculate an approximate debiasing factor by assuming
the source <span class="math">\(z(r_i)\)</span> is itself a Gaussian with moments <span class="math">\(Q_i\)</span> of the
form:</p>
<div class="math">
\[ \begin{align}\begin{aligned}z(r_i) = \frac{e^{-\frac{1}{2}(r_i - Q_1) Q_2^{-1}(r_i-Q_1)^T}}{z_0}\\z_0(Q_2) = \int_{-\infty}^{\infty}e^{-1\frac{1}{2}rQ^{-1}_2r^T}d^kr\end{aligned}\end{align} \]</div>
<div class="section" id="zeroth-moment">
<h4>Zeroth Moment<a class="headerlink" href="#zeroth-moment" title="Permalink to this headline">¶</a></h4>
<p>With this assumption the calculation of <span class="math">\(R_0\)</span> becomes:</p>
<div class="math">
\[R_0 = \frac{1}{W_0}\frac{Q_0}{z_0(Q_2)}\int_{-\infty}^{\infty}
      e^{-\frac{1}{2}(r-Q_1)Q_2^{-1}(r-Q_1)^T} e^{-\frac{1}{2}(r-C_1)C_2^{-1}
      (r-C_1)^T} d^kr\]</div>
<p>Using the Matrix cook book, we recognize the integral can be re-expressed as:</p>
<div class="math">
\[ \begin{align}\begin{aligned}= \frac{1}{N}\int_{-\infty}^{\infty}e^{-\frac{1}{2}(r-\alpha)\beta^-1
                                       (r-\alpha)^T}d^kr\\N = \sqrt{\det(2\pi(Q_2^{-1} + C_2^{-1}))}\\\alpha = (Q_2^{-1} + C_2^{-1})^{-1}(Q_2^{-1}Q_1 + C_2^{-1}C_1)\\\beta = (Q_2^{-1} + C_2^{-1})^{-1}\end{aligned}\end{align} \]</div>
<p>If we make the assumption that <span class="math">\(\beta_x\beta_y - \beta_{xy}^2 &gt; 0\)</span> the
above integral evaluates to:</p>
<div class="math">
\[= \frac{1}{N}\frac{2 \, \sqrt{2} \sqrt{\frac{1}{2}} \pi}{\sqrt{\beta_{x}}
  \sqrt{-\frac{\beta_{\mathit{xy}}^{2} - \beta_{x} \beta_{y}}{\beta_{x}}}}\]</div>
</div>
<div class="section" id="first-moment">
<h4>First Moment<a class="headerlink" href="#first-moment" title="Permalink to this headline">¶</a></h4>
<p>see <a class="reference external" href="#first_raw_moment">eq 1</a></p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Nate B. Lust.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/algorithmWriteup.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>